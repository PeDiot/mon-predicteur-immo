---
title: "Vue d'ensemble des données décrivant les biens immobiliers"
date: '05-12-2022'
output: 
  html_document:
    toc : true
    toc_depth : 4
    number_sections: true
    theme: readable
    highlight: tango
    toc_float:
      collapsed: false
      smooth_scroll: false
    css: style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE)
```

```{r}
library(data.table)
library(DT)
library(ggplot2)
library(ggpubr)
library(readxl)

dt <- read_excel("../data/Datachallenge_anonymise.xls")
dt <- as.data.table(dt)
N <- dt[, length(unique(descriptif_bien_id))]
Ncol <- length(names(dt))
```

# Vue d'ensemble des variables
 
- Il y a au total `r N` biens décrits par `r Ncol` variables;
- Le sens des variables est facile à comprendre pour celle dont le nom commence par `descriptif_`.
- Pour les autres variables, voir le fichier **MTS_dictionnaire_donnees_bien.xlsx**.

```{r}
# Class of variables
dt_class <- dt[, lapply( .SD, function(X) class(X) )]
dt_class <- data.table(variable = names(dt_class), class = t(dt_class)[, 1])
dt_class[, class := ifelse(grepl("_has_|_is_", variable), "logical", class)]

# %tage of NA
dt_na <- dt[, lapply(.SD, function(X) round(sum(is.na(X)) / .N * 100, 2))]
dt_na <- data.table(variable = names(dt_na), pourcentage_NA = t(dt_na)[, 1])

# Merge
dt_meta <- merge(x = dt_class, y = dt_na, by = "variable", all.x = TRUE)
rm(dt_na, dt_class)

# View datatable
datatable(dt_meta)
```

## Variables identifiantes

```{r}
col_id <- c("descriptif_bien_id", "descriptif_bien_code_postal", "descriptif_bien_ville")
datatable(dt_meta[variable %in% col_id])
```


## Variables dates
```{r}
col_date <- grep(pattern = "Date|date|annee", x = names(dt), value = TRUE)
datatable(dt_meta[variable %in% col_date])
```

# Variables qualitatives

## Nombre de modalités 
```{r}
# Number of modalitties per variable
col_char <- dt_meta[class == "character" & (! variable %in% c(col_date, col_id)), variable]
dt_label <- rbindlist(lapply(col_char, function(col){
  lab <- dt[, get(col)]
  lab <- length(unique(lab))
  data.table(variable = col, nbr_modalites = lab)
}))
dt_meta_varqual <- merge(x = dt_meta, y = dt_label, by = "variable")
datatable(dt_meta_varqual)
```

## Quelques plots
 
- Les graphiques ci-dessous sont ceux des variables ayant au plus 4 modalités.
 
```{r}
col_varqual <- dt_meta_varqual[nbr_modalites <= 4, variable]
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[1]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=2.5, fig.width=7}
col <- col_varqual[2]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[3]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[4]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[5]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[6]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[7]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[8]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[9]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[10]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[11]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[12]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[13]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[14]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

```{r fig.align='center', fig.height=3.5, fig.width=7}
col <- col_varqual[15]
n <- dt[! is.na(get(col)), .N]
  dt_x <- dt[! is.na(get(col)), .("pourcentage" = round(.N / n * 100, 2)), by = col]
ggplot(dt_x, aes(x = get(col), y = pourcentage)) + 
  geom_bar(stat = "identity", fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
```

# Variables quantitatives

## Quelques statistiques
```{r}
col_num <- dt_meta[class == "numeric" & 
                     (! variable %in% c("contact_emprunteur_id", "N° automatique",
                                        "descriptif_bien_numero_dossier",
                                        "gobal_bdd_connaissance_mts_id", col_date, col_id)),
                   variable]
dt_summary <- rbindlist(lapply(col_num, function(col){
  x <- dt[, base::get(col)]
  data.table("variable" = col, "min" = min(x, na.rm = TRUE), 
             "q0.025" = round(quantile(x, 0.025, na.rm = TRUE), 2), 
             "q0.25" = round(quantile(x, 0.25, na.rm = TRUE), ), 
             "q0.5" = round(quantile(x, 0.5, na.rm = TRUE), 2), 
             "mean" = round(mean(x, na.rm = TRUE), 2),
             "q0.75" = round(quantile(x, 0.75, na.rm = TRUE), 2), 
             "q0.975" = round(quantile(x, 0.975, na.rm = TRUE), 2), 
             "max" = round(max(x, na.rm = TRUE), 2))
}))

DT::datatable(dt_summary)
```


## Quelques plots
 
- Histogramme et diagramme à moustache des variables quantitaves.
- NB : Dans certains cas, quelques valeurs extrêmes ont étés ignorées.
 
```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[1]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[2]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[3]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[4]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[5]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[6]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[7]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[8]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[9]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[10]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[11]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[12]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[13]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[14]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[15]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[16]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[17]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[18]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[19]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[20]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[21]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[22]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[23]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[24]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[25]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[26]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```

```{r fig.align='center', fig.height=3.5, fig.width=8}
col <- col_num[27]
x <- dt[, base::get(col)]
x <- x[! is.na(x)]
dt_x <- data.table(x = x[! x >= quantile(x, 0.99)])
ghist <- ggplot(dt_x, aes(x = x)) + 
  geom_histogram(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()

gboxp <- ggplot(dt_x, aes(x = x)) + 
  geom_boxplot(fill="steelblue") + xlab("") + ggtitle(col) +
  theme_minimal()
ggarrange(gboxp, ghist, ncol = 2)
```




